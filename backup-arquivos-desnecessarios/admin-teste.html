<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Teste - Granja Recanto Feliz</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-2xl font-bold mb-4">Admin Teste - Produtos</h1>
        
        <div id="status" class="mb-4 p-4 bg-blue-100 rounded">
            Carregando sistema...
        </div>
        
        <div id="produtos" class="bg-white p-4 rounded shadow">
            <!-- Produtos ser√£o listados aqui -->
        </div>
    </div>

    <script>
        console.log('üöÄ Iniciando admin teste...');
        
        // Verificar se h√° dados no localStorage
        const storageData = localStorage.getItem('granjaRecantoFelizData');
        const statusDiv = document.getElementById('status');
        const produtosDiv = document.getElementById('produtos');
        
        if (storageData) {
            try {
                const data = JSON.parse(storageData);
                const produtos = data.products || [];
                
                statusDiv.innerHTML = `‚úÖ Sistema carregado - ${produtos.length} produtos encontrados`;
                statusDiv.className = 'mb-4 p-4 bg-green-100 rounded';
                
                if (produtos.length > 0) {
                    let html = '<h2 class="text-xl font-bold mb-4">Lista de Produtos:</h2>';
                    
                    produtos.forEach(produto => {
                        html += `
                            <div class="border p-3 mb-2 rounded">
                                <h3 class="font-bold">${produto.name}</h3>
                                <p>Pre√ßo: R$ ${produto.price}</p>
                                <p>Estoque: ${produto.stock}</p>
                                <button onclick="editarProduto(${produto.id})" 
                                        class="bg-blue-500 text-white px-3 py-1 rounded mt-2">
                                    Editar
                                </button>
                            </div>
                        `;
                    });
                    
                    produtosDiv.innerHTML = html;
                } else {
                    produtosDiv.innerHTML = '<p>Nenhum produto encontrado.</p>';
                }
                
            } catch (error) {
                statusDiv.innerHTML = `‚ùå Erro ao carregar dados: ${error.message}`;
                statusDiv.className = 'mb-4 p-4 bg-red-100 rounded';
            }
        } else {
            statusDiv.innerHTML = '‚ö†Ô∏è Nenhum dado encontrado no localStorage';
            statusDiv.className = 'mb-4 p-4 bg-yellow-100 rounded';
            
            // Criar dados de teste
            const dadosTeste = {
                products: [
                    {
                        id: 1,
                        name: "Galinha Caipira Inteira",
                        price: 110,
                        stock: 8,
                        category: "Aves"
                    }
                ],
                lastUpdate: new Date().toISOString()
            };
            
            localStorage.setItem('granjaRecantoFelizData', JSON.stringify(dadosTeste));
            
            produtosDiv.innerHTML = `
                <p>Dados de teste criados!</p>
                <button onclick="location.reload()" class="bg-green-500 text-white px-3 py-1 rounded">
                    Recarregar P√°gina
                </button>
            `;
        }
        
        // Fun√ß√£o para editar produto (simplificada)
        window.editarProduto = function(id) {
            const novoPreco = prompt('Novo pre√ßo:');
            const novoEstoque = prompt('Novo estoque:');
            
            if (novoPreco && novoEstoque) {
                try {
                    const data = JSON.parse(localStorage.getItem('granjaRecantoFelizData'));
                    const produto = data.products.find(p => p.id === id);
                    
                    if (produto) {
                        produto.price = parseFloat(novoPreco);
                        produto.stock = parseInt(novoEstoque);
                        
                        localStorage.setItem('granjaRecantoFelizData', JSON.stringify(data));
                        
                        alert('Produto atualizado com sucesso!');
                        location.reload();
                    }
                } catch (error) {
                    alert('Erro ao salvar: ' + error.message);
                }
            }
        };
    </script>
</body>
</html>
