<!DOCTYPE html>
<html>
<head>
    <title>Criar Banco SQLite Real</title>
</head>
<body>
    <h1>Criando Banco SQLite Real...</h1>
    <div id="status"></div>
    
    <!-- SQL.js desativado: <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script> -->
    <script>
        async function criarBancoReal() {
            const status = document.getElementById('status');
            
            try {
                // Inicializar SQL.js
                const SQL = await initSqlJs({
                    locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/${file}`
                });
                
                // Criar banco
                const db = new SQL.Database();
                
                // Criar tabela
                db.run(`
                    CREATE TABLE produtos (
                        id INTEGER PRIMARY KEY,
                        name TEXT NOT NULL,
                        category TEXT,
                        price REAL,
                        stock INTEGER,
                        slogan TEXT,
                        description TEXT,
                        image TEXT,
                        active BOOLEAN DEFAULT 1
                    )
                `);
                
                // Inserir produtos padrão
                const produtos = [
                    [1, "Substrato BioFértil 3 Anos", "fertilizantes", 40.00, 25, "Mais do que Adubo: um substrato vivo e completo.", "Com um processo de maturação de 3 anos, nosso substrato é uma terra viva e completa, rica em matéria orgânica e microrganismos benéficos.", "imagens/produtos/1/1.png"],
                    [2, "FertiGota", "fertilizantes", 25.00, 40, "Adubo de galinha líquido e potente.", "Nosso fertilizante líquido é produzido através de um processo de biodigestor anaeróbico, transformando dejetos de galinha em um adubo rico em nutrientes e de fácil absorção pelas plantas.", "imagens/produtos/2/1.png"],
                    [3, "Ovos Caipira 10", "ovos", 18.00, 120, "10 ovos frescos da granja.", "Ovos caipira selecionados, direto da granja para sua mesa. Embalagem com 10 unidades.", "imagens/produtos/3/1.jpeg"],
                    [4, "Ovos Caipira 20", "ovos", 30.00, 80, "20 ovos frescos da granja.", "Ovos caipira selecionados, direto da granja para sua mesa. Embalagem com 20 unidades.", "imagens/produtos/4/1.jpeg"],
                    [5, "Ovos Caipira 30", "ovos", 45.00, 50, "30 ovos frescos da granja.", "Ovos caipira selecionados, direto da granja para sua mesa. Embalagem com 30 unidades.", "imagens/produtos/5/1.png"],
                    [6, "Galinha Caipira Picada", "aves", 60.00, 15, "Galinha caipira cortada, pronta para cozinhar.", "Galinha caipira picada, sabor autêntico da roça. Ideal para receitas tradicionais.", "imagens/produtos/6/1.png"],
                    [7, "Galinha Caipira Inteira", "aves", 110.00, 8, "Galinha caipira inteira, fresca e saborosa.", "Galinha caipira inteira, criada solta e alimentada naturalmente. Perfeita para assados e cozidos.", "imagens/produtos/7/1.png"]
                ];
                
                produtos.forEach(produto => {
                    db.run(`INSERT INTO produtos (id, name, category, price, stock, slogan, description, image) 
                            VALUES (?, ?, ?, ?, ?, ?, ?, ?)`, produto);
                });
                
                // Exportar banco como arquivo
                const data = db.export();
                const blob = new Blob([data], {type: 'application/x-sqlite3'});
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = 'granja-recanto-feliz.db';
                a.click();
                
                status.innerHTML = '✅ Banco SQLite criado e baixado! Coloque o arquivo na pasta src/';
                
                // Salvar também no localStorage para compatibilidade
                const produtosObj = produtos.map(p => ({
                    id: p[0],
                    name: p[1],
                    category: p[2],
                    price: p[3],
                    stock: p[4],
                    slogan: p[5],
                    description: p[6],
                    image: p[7],
                    active: true
                }));
                
                localStorage.setItem('granjaRecantoFelizData', JSON.stringify({
                    products: produtosObj,
                    lastUpdate: new Date().toISOString(),
                    hasSQLite: true
                }));
                
            } catch (error) {
                status.innerHTML = '❌ Erro: ' + error.message;
            }
        }
        
        criarBancoReal();
    </script>
</body>
</html>