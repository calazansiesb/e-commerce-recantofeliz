<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administração - Granja Recanto Feliz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; }
        h1, h2, h3 { font-family: 'Lora', serif; }
    </style>
</head>
<body class="bg-gray-50">
    
    <!-- Header Administrativo -->
    <header class="bg-[#5D4037] text-white p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <i class="fas fa-cog text-2xl"></i>
                <h1 class="text-2xl font-bold font-lora">Administração - Granja Recanto Feliz</h1>
            </div>
            <div class="flex items-center space-x-4">
                <a href="index.html" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition">
                    <i class="fas fa-home mr-2"></i>Voltar ao Site
                </a>
                <button id="logout-btn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg transition">
                    <i class="fas fa-sign-out-alt mr-2"></i>Sair
                </button>
            </div>
        </div>
    </header>

    <!-- Menu de Navegação -->
    <nav class="bg-white shadow-md p-4">
        <div class="container mx-auto">
            <div class="flex space-x-6">
                <button onclick="showSection('produtos')" class="nav-btn bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">
                    <i class="fas fa-box mr-2"></i>Produtos
                </button>
                <button onclick="window.open('gestao-pedidos.html', '_blank')" class="nav-btn bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition">
                    <i class="fas fa-shopping-cart mr-2"></i>Pedidos
                </button>
                <button onclick="showSection('estoque')" class="nav-btn bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition">
                    <i class="fas fa-warehouse mr-2"></i>Estoque
                </button>
                <button onclick="showSection('layouts')" class="nav-btn bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600 transition">
                    <i class="fas fa-palette mr-2"></i>Layouts
                </button>
                <button onclick="showSection('carrossel')" class="nav-btn bg-indigo-500 text-white px-4 py-2 rounded-lg hover:bg-indigo-600 transition">
                    <i class="fas fa-images mr-2"></i>Temas Carrossel
                </button>
                <button onclick="showSection('mensagens')" class="nav-btn bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition">
                    <i class="fas fa-comment mr-2"></i>Mensagens
                </button>
            </div>
        </div>
    </nav>

    <!-- Container Principal -->
    <div class="container mx-auto p-6">
        
        <!-- Seção: Gestão de Produtos -->
        <div id="produtos-section" class="section">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold font-lora text-[#5D4037]">Gestão de Produtos</h2>
                    <div class="flex space-x-3">
                        <button onclick="salvarProdutosDefinitivo()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition font-bold">
                            <i class="fas fa-save mr-2"></i>SALVAR DEFINITIVO
                        </button>
                        <button onclick="openProductModal()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition">
                            <i class="fas fa-plus mr-2"></i>Novo Produto
                        </button>
                    </div>
                </div>

                <!-- Lista de Produtos -->
                <div class="overflow-x-auto">
                    <table class="w-full table-auto">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="px-4 py-3 text-left">ID</th>
                                <th class="px-4 py-3 text-left">Imagem</th>
                                <th class="px-4 py-3 text-left">Nome</th>
                                <th class="px-4 py-3 text-left">Categoria</th>
                                <th class="px-4 py-3 text-left">Preço</th>
                                <th class="px-4 py-3 text-left">Estoque</th>
                                <th class="px-4 py-3 text-left">Ações</th>
                            </tr>
                        </thead>
                        <tbody id="products-table-body">
                            <!-- Produtos serão carregados aqui via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Seção: Controle de Estoque -->
        <div id="estoque-section" class="section hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-3xl font-bold font-lora text-[#5D4037] mb-6">Controle de Estoque</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="estoque-grid">
                    <!-- Cards de estoque serão carregados aqui -->
                </div>
            </div>
        </div>

        <!-- Seção: Layouts Temáticos -->
        <div id="layouts-section" class="section hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold font-lora text-[#5D4037]">Layouts Temáticos</h2>
                    <div class="flex space-x-3">
                        <button onclick="restoreProducts()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition">
                            <i class="fas fa-box mr-2"></i>Restaurar Produtos
                        </button>
                        <button onclick="updateLayoutsFromDefaults()" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition">
                            <i class="fas fa-sync mr-2"></i>Atualizar Layouts
                        </button>
                        <button onclick="checkAutoLayouts()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition">
                            <i class="fas fa-magic mr-2"></i>Verificar Automático
                        </button>
                        <button onclick="activateDefaultLayout()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition">
                            <i class="fas fa-undo mr-2"></i>Layout Padrão
                        </button>
                    </div>
                </div>

                <!-- Status do Layout Atual -->
                <div id="current-layout-status" class="mb-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
                    <h3 class="font-bold text-blue-700 mb-2">
                        <i class="fas fa-info-circle mr-2"></i>Layout Atual
                    </h3>
                    <div id="current-layout-info" class="text-blue-600">
                        Carregando informações do layout...
                    </div>
                </div>

                <!-- Lista de Layouts Disponíveis -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="layouts-grid">
                    <!-- Layouts serão carregados dinamicamente -->
                </div>

                <!-- Seção de Configuração Personalizada -->
                <div class="mt-8 bg-gray-50 p-6 rounded-lg">
                    <h3 class="text-xl font-bold mb-4">
                        <i class="fas fa-cog mr-2"></i>Configurações Avançadas
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Configuração de Cores -->
                        <div class="space-y-4">
                            <h4 class="font-bold text-gray-700">Paleta de Cores Personalizada</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-600 mb-1">Cor Primária</label>
                                    <input type="color" id="custom-primary" class="w-full h-10 rounded" value="#2D5016">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-600 mb-1">Cor Secundária</label>
                                    <input type="color" id="custom-secondary" class="w-full h-10 rounded" value="#8B4513">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-600 mb-1">Cor de Destaque</label>
                                    <input type="color" id="custom-accent" class="w-full h-10 rounded" value="#228B22">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-600 mb-1">Cor de Fundo</label>
                                    <input type="color" id="custom-background" class="w-full h-10 rounded" value="#F0F8E8">
                                </div>
                            </div>
                        </div>

                        <!-- Configuração de Banner -->
                        <div class="space-y-4">
                            <h4 class="font-bold text-gray-700">Banner Personalizado</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-600 mb-1">Texto do Banner</label>
                                    <textarea id="custom-banner-text" class="w-full p-2 border rounded-lg" rows="3" placeholder="Digite o texto do banner...">Granja Recanto Feliz - Produtos Frescos da Fazenda</textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-600 mb-1">Imagem do Banner</label>
                                    <select id="custom-banner-image" class="w-full p-2 border rounded-lg">
                                        <option value="imagens/produtos/8/1.png">Imagem padrão</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 flex space-x-3">
                        <button onclick="previewCustomLayout()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition">
                            <i class="fas fa-eye mr-2"></i>Visualizar
                        </button>
                        <button onclick="applyCustomLayout()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition">
                            <i class="fas fa-paint-brush mr-2"></i>Aplicar Layout
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção: Banco de Dados -->
        <div id="database-section" class="section hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-3xl font-bold font-lora text-[#5D4037] mb-6">Gerenciamento do Banco de Dados</h2>
                
                <!-- Status do Sistema -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-blue-500 text-white p-6 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-database text-3xl mr-4"></i>
                            <div>
                                <p class="text-lg font-semibold">SQLite Status</p>
                                <p class="text-xl font-bold" id="sqlite-status">Verificando...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-green-500 text-white p-6 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-sync text-3xl mr-4"></i>
                            <div>
                                <p class="text-lg font-semibold">Sincronização</p>
                                <p class="text-xl font-bold" id="sync-status">Verificando...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-purple-500 text-white p-6 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-backup text-3xl mr-4"></i>
                            <div>
                                <p class="text-lg font-semibold">Backup</p>
                                <p class="text-xl font-bold" id="backup-status">Automático</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Controles do Banco de Dados -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Diagnóstico -->
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-xl font-bold mb-4">
                            <i class="fas fa-stethoscope mr-2 text-purple-600"></i>Diagnóstico do Sistema
                        </h3>
                        <p class="text-gray-600 mb-4">Verificar status dos componentes e integridade dos dados.</p>
                        <button onclick="runFullDiagnostic()" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg transition w-full">
                            <i class="fas fa-play mr-2"></i>Executar Diagnóstico
                        </button>
                        <div id="diagnostic-results" class="mt-4 p-3 bg-white rounded border hidden">
                            <h4 class="font-bold mb-2">Resultados:</h4>
                            <pre id="diagnostic-output" class="text-sm text-gray-700 whitespace-pre-wrap"></pre>
                        </div>
                    </div>
                    
                    <!-- Migração de Dados -->
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-xl font-bold mb-4">
                            <i class="fas fa-exchange-alt mr-2 text-blue-600"></i>Migração de Dados
                        </h3>
                        <p class="text-gray-600 mb-4">Migrar dados do localStorage para SQLite ou vice-versa.</p>
                        <div class="space-y-3">
                            <button onclick="migrateToSQLite()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition w-full">
                                <i class="fas fa-arrow-right mr-2"></i>localStorage → SQLite
                            </button>
                            <button onclick="exportToLocalStorage()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition w-full">
                                <i class="fas fa-arrow-left mr-2"></i>SQLite → localStorage
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Logs do Sistema -->
                <div class="mt-8 bg-gray-50 p-6 rounded-lg">
                    <h3 class="text-xl font-bold mb-4">
                        <i class="fas fa-list mr-2 text-green-600"></i>Logs do Sistema
                    </h3>
                    <div class="bg-black text-green-400 p-4 rounded font-mono text-sm h-64 overflow-y-auto" id="system-logs">
                        <div>Sistema iniciando...</div>
                    </div>
                    <div class="mt-3 flex space-x-3">
                        <button onclick="clearLogs()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded transition">
                            <i class="fas fa-trash mr-2"></i>Limpar Logs
                        </button>
                        <button onclick="refreshLogs()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition">
                            <i class="fas fa-sync mr-2"></i>Atualizar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção: Relatórios -->
        <div id="relatorios-section" class="section hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-3xl font-bold font-lora text-[#5D4037] mb-6">Relatórios</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-blue-500 text-white p-6 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-box text-3xl mr-4"></i>
                            <div>
                                <p class="text-lg font-semibold">Total Produtos</p>
                                <p class="text-3xl font-bold" id="total-produtos">7</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-green-500 text-white p-6 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-dollar-sign text-3xl mr-4"></i>
                            <div>
                                <p class="text-lg font-semibold">Valor Total</p>
                                <p class="text-3xl font-bold" id="valor-total">R$ 0,00</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-500 text-white p-6 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-exclamation-triangle text-3xl mr-4"></i>
                            <div>
                                <p class="text-lg font-semibold">Estoque Baixo</p>
                                <p class="text-3xl font-bold" id="estoque-baixo">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-red-500 text-white p-6 rounded-lg">
                        <div class="flex items-center">
                            <i class="fas fa-times-circle text-3xl mr-4"></i>
                            <div>
                                <p class="text-lg font-semibold">Sem Estoque</p>
                                <p class="text-3xl font-bold" id="sem-estoque">0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção: Temas de Carrossel -->
        <div id="carrossel-section" class="section hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold font-lora text-[#5D4037]">Temas de Carrossel</h2>
                    <button onclick="addCarouselTheme()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition">
                        <i class="fas fa-plus mr-2"></i>Novo Tema
                    </button>
                </div>

                <!-- Lista de Temas Disponíveis -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="carousel-themes-grid">
                    <!-- Temas serão carregados dinamicamente -->
                </div>
            </div>
        </div>

        <!-- Seção: Mensagens Personalizadas -->
        <div id="mensagens-section" class="section hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-3xl font-bold font-lora text-[#5D4037] mb-6">Mensagens Personalizadas</h2>
                
                <!-- Mensagem de Agradecimento -->
                <div class="bg-gray-50 p-6 rounded-lg mb-6">
                    <h3 class="text-xl font-bold mb-4">
                        <i class="fas fa-heart mr-2 text-red-500"></i>Mensagem de Agradecimento
                    </h3>
                    <p class="text-gray-600 mb-4">Mensagem exibida após o cliente enviar o pedido via WhatsApp</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Configuração da Mensagem -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Texto da Mensagem</label>
                            <textarea id="mensagem-agradecimento" rows="6" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Digite a mensagem de agradecimento...">
Olá, {nome}!
Seu pedido {pedido} foi confirmado e já estamos preparando com carinho.
Muito obrigado por escolher nossos produtos naturais.
Logo, logo estará aí!
Recanto Feliz</textarea>
                            <p class="text-xs text-gray-500 mt-2">
                                <strong>Variáveis disponíveis:</strong><br>
                                {nome} - Nome do cliente<br>
                                {pedido} - Número do pedido
                            </p>
                        </div>
                        
                        <!-- Configuração da Imagem -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Imagem de Agradecimento</label>
                            <div class="space-y-4">
                                <div>
                                    <input type="file" id="imagem-agradecimento-upload" accept="image/*" class="w-full p-3 border border-gray-300 rounded-lg">
                                    <p class="text-xs text-gray-500 mt-1">Selecione uma nova imagem</p>
                                </div>
                                
                                <div class="text-center text-gray-500 text-sm">
                                    <span class="bg-gray-100 px-3 py-1 rounded">OU</span>
                                </div>
                                
                                <div>
                                    <input type="text" id="imagem-agradecimento-url" class="w-full p-3 border border-gray-300 rounded-lg" placeholder="URL da imagem" value="imagens/agradecimento pedido.png">
                                    <p class="text-xs text-gray-500 mt-1">Caminho da imagem atual</p>
                                </div>
                                
                                <!-- Preview da Imagem -->
                                <div id="preview-agradecimento" class="mt-4">
                                    <img id="preview-img-agradecimento" src="imagens/agradecimento pedido.png" alt="Preview" class="w-full h-48 object-cover rounded-lg border" onerror="this.style.display='none'">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex space-x-3">
                        <button onclick="salvarMensagemAgradecimento()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition">
                            <i class="fas fa-save mr-2"></i>Salvar Mensagem
                        </button>
                        <button onclick="testarMensagemAgradecimento()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition">
                            <i class="fas fa-eye mr-2"></i>Visualizar
                        </button>
                        <button onclick="restaurarMensagemPadrao()" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg transition">
                            <i class="fas fa-undo mr-2"></i>Restaurar Padrão
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Adicionar/Editar Tema de Carrossel -->
    <div id="carousel-theme-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold font-lora text-[#5D4037]" id="carousel-modal-title">Novo Tema de Carrossel</h3>
                <button onclick="closeCarouselThemeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="carousel-theme-form" class="space-y-6">
                <input type="hidden" id="carousel-theme-id">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Tema</label>
                        <input type="text" id="theme-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                        <select id="theme-category" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">Selecione uma categoria</option>
                            <option value="ovos">Ovos Caipira</option>
                            <option value="adubo">Adubo Orgânico</option>
                            <option value="galinhas">Galinhas Caipira</option>
                            <option value="parceiros">Produtos de Parceiros</option>
                            <option value="completo">Mesa Completa</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Título do Slide</label>
                    <input type="text" id="theme-title" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                    <textarea id="theme-description" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Imagem do Tema</label>
                    <div class="space-y-4">
                        <!-- Opção 1: Upload de Arquivo -->
                        <div>
                            <label class="block text-sm font-medium text-gray-600 mb-2">Upload de Imagem</label>
                            <input type="file" id="theme-image-upload" accept="image/*" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <p class="text-xs text-gray-500 mt-1">Selecione uma imagem do seu computador</p>
                        </div>
                        
                        <!-- Ou -->
                        <div class="text-center text-gray-500 text-sm">
                            <span class="bg-gray-100 px-3 py-1 rounded">OU</span>
                        </div>
                        
                        <!-- Opção 2: URL da Imagem -->
                        <div>
                            <label class="block text-sm font-medium text-gray-600 mb-2">URL da Imagem</label>
                            <input type="url" id="theme-image" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <p class="text-xs text-gray-500 mt-1">Cole o link de uma imagem (Unsplash, etc.)</p>
                        </div>
                        
                        <!-- Preview da Imagem -->
                        <div id="theme-image-preview" class="hidden">
                            <label class="block text-sm font-medium text-gray-600 mb-2">Preview</label>
                            <img id="theme-preview-img" src="" alt="Preview" class="w-full h-48 object-cover rounded-lg border">
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Texto do Botão</label>
                        <input type="text" id="theme-button-text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Link do Botão</label>
                        <input type="text" id="theme-button-link" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Cor do Botão</label>
                    <input type="color" id="theme-button-color" class="w-full h-12 border border-gray-300 rounded-lg" value="#4CAF50">
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="theme-active" class="mr-2">
                    <label for="theme-active" class="text-sm font-medium text-gray-700">Tema Ativo (aparecerá no carrossel)</label>
                </div>
                
                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 px-6 rounded-lg transition">
                        <i class="fas fa-save mr-2"></i>Salvar Tema
                    </button>
                    <button type="button" onclick="closeCarouselThemeModal()" class="bg-gray-500 hover:bg-gray-600 text-white py-3 px-6 rounded-lg transition">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Adicionar/Editar Produto -->
    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold font-lora text-[#5D4037]" id="modal-title">Novo Produto</h3>
                <button onclick="closeProductModal()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="product-form" class="space-y-6">
                <input type="hidden" id="product-id">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Produto</label>
                        <input type="text" id="product-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Produto</label>
                        <select id="product-type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required onchange="togglePartnerFields()">
                            <option value="">Selecione o tipo</option>
                            <option value="granja">Produto da Granja</option>
                            <option value="parceiro">Produto de Parceiro</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                        <div class="flex gap-2">
                            <select id="product-category" class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required onchange="toggleCustomCategory()">
                                <option value="">Selecione uma categoria</option>
                                <option value="fertilizantes">Fertilizantes</option>
                                <option value="ovos">Ovos</option>
                                <option value="aves">Aves</option>
                                <option value="laticínios">Laticínios</option>
                                <option value="doces">Doces</option>
                                <option value="mel">Mel</option>
                                <option value="custom">Nova Categoria</option>
                            </select>
                        </div>
                        <input type="text" id="custom-category" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mt-2 hidden" placeholder="Digite a nova categoria">
                    </div>
                    
                    <div id="partner-fields" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Parceiro</label>
                        <input type="text" id="partner-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ex: Apiário Flor do Cerrado">
                    </div>
                </div>
                
                <div id="partner-details" class="hidden grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Produtor</label>
                        <input type="text" id="partner-producer" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ex: Sr. João Silva">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Localização</label>
                        <input type="text" id="partner-location" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ex: Planaltina - DF">
                    </div>
                </div>
                
                <div id="partner-description-field" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Sobre o Parceiro</label>
                    <textarea id="partner-description" rows="2" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ex: Família tradicional na apicultura há 3 gerações"></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Slogan</label>
                    <input type="text" id="product-slogan" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                    <textarea id="product-description" rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required></textarea>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Preço (R$)</label>
                        <input type="number" id="product-price" step="0.01" min="0" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Estoque</label>
                        <input type="number" id="product-stock" min="0" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Upload de Imagens</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                        <input type="file" id="product-images" multiple accept="image/*" class="hidden">
                        <button type="button" onclick="document.getElementById('product-images').click()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition">
                            <i class="fas fa-cloud-upload-alt mr-2"></i>Selecionar Imagens
                        </button>
                        <p class="text-gray-500 mt-2">Selecione múltiplas imagens (JPEG, PNG)</p>
                        <p class="text-gray-400 text-sm">Clique na imagem para definir como principal</p>
                        <div id="image-preview" class="mt-4 grid grid-cols-4 gap-2"></div>
                    </div>
                </div>
                
                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 px-6 rounded-lg transition">
                        <i class="fas fa-save mr-2"></i>Salvar Produto
                    </button>
                    <button type="button" onclick="closeProductModal()" class="bg-gray-500 hover:bg-gray-600 text-white py-3 px-6 rounded-lg transition">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Verificar autenticação
        if (!sessionStorage.getItem('adminAuth')) {
            window.location.href = 'admin/login.html';
        }
        
        // Logout
        document.getElementById('logout-btn').addEventListener('click', function() {
            sessionStorage.removeItem('adminAuth');
            window.location.href = 'admin/login.html';
        });
        
        // Funções para a seção de banco de dados
        async function runFullDiagnostic() {
            const output = document.getElementById('diagnostic-output');
            const results = document.getElementById('diagnostic-results');
            
            output.textContent = 'Executando diagnóstico...\n';
            results.classList.remove('hidden');
            
            try {
                if (typeof diagnosticDatabase === 'function') {
                    // Capturar logs do console temporariamente
                    const originalLog = console.log;
                    let logOutput = '';
                    
                    console.log = (...args) => {
                        logOutput += args.join(' ') + '\n';
                        originalLog.apply(console, args);
                    };
                    
                    await diagnosticDatabase();
                    
                    // Restaurar console.log
                    console.log = originalLog;
                    
                    output.textContent = logOutput;
                } else {
                    output.textContent = 'Função de diagnóstico não disponível';
                }
            } catch (error) {
                output.textContent = `Erro durante diagnóstico: ${error.message}`;
            }
        }
        
        async function migrateToSQLite() {
            addLog('Iniciando migração localStorage → SQLite');
            try {
                if (typeof initializeDatabaseManager === 'function') {
                    await initializeDatabaseManager();
                    addLog('✅ Migração concluída');
                    updateDatabaseStatus();
                } else {
                    addLog('❌ Função de migração não disponível');
                }
            } catch (error) {
                addLog(`❌ Erro na migração: ${error.message}`);
            }
        }
        
        async function exportToLocalStorage() {
            addLog('Iniciando exportação SQLite → localStorage');
            try {
                if (window.dbManager && window.dbManager.isInitialized) {
                    const products = await window.dbManager.getProducts();
                    const data = {
                        products: products,
                        lastUpdate: new Date().toISOString()
                    };
                    localStorage.setItem('granjaRecantoFelizData', JSON.stringify(data));
                    addLog(`✅ ${products.length} produtos exportados para localStorage`);
                } else {
                    addLog('❌ DatabaseManager não inicializado');
                }
            } catch (error) {
                addLog(`❌ Erro na exportação: ${error.message}`);
            }
        }
        
        function addLog(message) {
            const logs = document.getElementById('system-logs');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.textContent = `[${timestamp}] ${message}`;
            logs.appendChild(logEntry);
            logs.scrollTop = logs.scrollHeight;
        }
        
        function clearLogs() {
            document.getElementById('system-logs').innerHTML = '<div>Logs limpos...</div>';
        }
        
        function refreshLogs() {
            addLog('Logs atualizados');
        }
        
        async function updateDatabaseStatus() {
            try {
                // Status SQLite
                const sqliteStatus = document.getElementById('sqlite-status');
                if (window.dbManager && window.dbManager.isInitialized) {
                    sqliteStatus.textContent = 'Conectado';
                    sqliteStatus.parentElement.parentElement.className = 'bg-green-500 text-white p-6 rounded-lg';
                } else {
                    sqliteStatus.textContent = 'Desconectado';
                    sqliteStatus.parentElement.parentElement.className = 'bg-red-500 text-white p-6 rounded-lg';
                }
                
                // Status de sincronização
                const syncStatus = document.getElementById('sync-status');
                syncStatus.textContent = 'Ativo';
                
            } catch (error) {
                console.error('Erro ao atualizar status:', error);
            }
        }
        
        // Atualizar status quando a página carrega
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(updateDatabaseStatus, 2000);
        });
        
        // Escutar evento de DatabaseManager pronto
        window.addEventListener('databaseManagerReady', function() {
            addLog('✅ DatabaseManager inicializado e pronto');
            updateDatabaseStatus();
        });
        
        // Funções para mensagens personalizadas
        function salvarMensagemAgradecimento() {
            const mensagem = document.getElementById('mensagem-agradecimento').value;
            const imagemUrl = document.getElementById('imagem-agradecimento-url').value;
            
            localStorage.setItem('mensagemAgradecimento', mensagem);
            localStorage.setItem('imagemAgradecimento', imagemUrl);
            
            alert('✅ Mensagem de agradecimento salva com sucesso!');
        }
        
        function testarMensagemAgradecimento() {
            const mensagem = document.getElementById('mensagem-agradecimento').value;
            const imagemUrl = document.getElementById('imagem-agradecimento-url').value;
            
            // Simular dados de teste
            const mensagemTeste = mensagem
                .replace(/{nome}/g, 'João da Silva')
                .replace(/{pedido}/g, 'RF12345678901');
            
            // Criar modal de teste
            const modalHTML = `
                <div id="modal-teste-agradecimento" style="
                    position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                    background: rgba(0,0,0,0.8); z-index: 3000; display: flex; 
                    align-items: center; justify-content: center;
                ">
                    <div style="
                        background: white; padding: 30px; border-radius: 15px; 
                        max-width: 500px; width: 90%; text-align: center;
                        box-shadow: 0 8px 32px rgba(0,0,0,0.3);
                    ">
                        <h3 style="margin-bottom: 15px; color: #5D4037;">Preview da Mensagem</h3>
                        <img src="${imagemUrl}" alt="Agradecimento" style="
                            max-width: 100%; height: auto; margin-bottom: 20px; border-radius: 10px;
                        " onerror="this.style.display='none'">
                        <div style="
                            font-size: 18px; line-height: 1.6; color: #333; 
                            white-space: pre-line; margin-bottom: 25px;
                        ">${mensagemTeste}</div>
                        <button onclick="fecharTesteMensagem()" style="
                            background: #25D366; color: white; border: none; 
                            padding: 12px 30px; border-radius: 8px; font-size: 16px;
                            cursor: pointer; font-weight: bold;
                        ">✅ Fechar Preview</button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        function fecharTesteMensagem() {
            const modal = document.getElementById('modal-teste-agradecimento');
            if (modal) modal.remove();
        }
        
        function restaurarMensagemPadrao() {
            const mensagemPadrao = `Olá, {nome}!
Seu pedido {pedido} foi confirmado e já estamos preparando com carinho.
Muito obrigado por escolher nossos produtos naturais.
Logo, logo estará aí!
Recanto Feliz`;
            
            document.getElementById('mensagem-agradecimento').value = mensagemPadrao;
            document.getElementById('imagem-agradecimento-url').value = 'imagens/agradecimento pedido.png';
            
            localStorage.removeItem('mensagemAgradecimento');
            localStorage.removeItem('imagemAgradecimento');
            
            alert('✅ Mensagem restaurada para o padrão!');
        }
        
        // Carregar mensagem salva ao abrir a seção
        function carregarMensagemSalva() {
            const mensagemSalva = localStorage.getItem('mensagemAgradecimento');
            const imagemSalva = localStorage.getItem('imagemAgradecimento');
            
            if (mensagemSalva) {
                document.getElementById('mensagem-agradecimento').value = mensagemSalva;
            }
            
            if (imagemSalva) {
                document.getElementById('imagem-agradecimento-url').value = imagemSalva;
                document.getElementById('preview-img-agradecimento').src = imagemSalva;
            }
        }
        
        // Upload de imagem de agradecimento
        document.addEventListener('DOMContentLoaded', function() {
            const uploadInput = document.getElementById('imagem-agradecimento-upload');
            if (uploadInput) {
                uploadInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const imagemUrl = e.target.result;
                            document.getElementById('imagem-agradecimento-url').value = imagemUrl;
                            document.getElementById('preview-img-agradecimento').src = imagemUrl;
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        });
        
        // Tornar funções globais
        window.salvarMensagemAgradecimento = salvarMensagemAgradecimento;
        window.testarMensagemAgradecimento = testarMensagemAgradecimento;
        window.restaurarMensagemPadrao = restaurarMensagemPadrao;
        window.fecharTesteMensagem = fecharTesteMensagem;
        window.carregarMensagemSalva = carregarMensagemSalva;
    </script>
    <!-- SQL.js desativado: não carregar no cliente para simplificar o fluxo -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script> -->
    <!-- <script src="js/sqlite-manager.js"></script> -->
    <!-- <script src="js/sqlite-robust-initializer.js"></script> -->
    <script src="js/unified-data-source.js"></script>
    <script src="js/data-manager.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/fix-admin-produtos.js"></script>
    <script>
        // Função simples para testar botões
        function showSection(sectionName) {
            console.log('Mostrando seção:', sectionName);
            
            // Ocultar todas as seções
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Mostrar seção alvo
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
                console.log('Seção exibida:', sectionName);
                
                // Carregar conteúdo específico
                if (sectionName === 'layouts') {
                    loadLayoutsGrid();
                    updateCurrentLayoutStatus();
                }
                
                if (sectionName === 'carrossel') {
                    loadCarouselThemes();
                }
                
                if (sectionName === 'estoque') {
                    loadEstoqueGrid();
                }
                
                if (sectionName === 'mensagens') {
                    carregarMensagemSalva();
                }
            } else {
                console.error('Seção não encontrada:', sectionName + '-section');
            }
        }
        
        // Tornar função global
        window.showSection = showSection;
        
        // Funções de layouts e temas reativadas
        function loadLayoutsGrid() {
            const layoutsGrid = document.getElementById('layouts-grid');
            if (!layoutsGrid || !window.dataManager) return;
            
            const layouts = window.dataManager.getLayouts();
            const currentLayout = window.dataManager.getCurrentLayout();
            
            layoutsGrid.innerHTML = Object.entries(layouts).map(([key, layout]) => {
                const isActive = currentLayout && currentLayout.theme === layout.theme;
                return `
                    <div class="border rounded-lg p-4 ${isActive ? 'border-green-500 bg-green-50' : 'border-gray-200'}">
                        <div class="flex justify-between items-start mb-3">
                            <h4 class="font-bold text-lg">${layout.name}</h4>
                            ${isActive ? '<span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded">ATIVO</span>' : ''}
                        </div>
                        <p class="text-sm text-gray-600 mb-4">${layout.bannerText}</p>
                        <div class="flex space-x-2">
                            ${!isActive ? `<button onclick="activateLayout('${key}')" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm">Ativar</button>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function updateCurrentLayoutStatus() {
            const statusInfo = document.getElementById('current-layout-info');
            if (!statusInfo || !window.dataManager) return;
            
            const currentLayout = window.dataManager.getCurrentLayout();
            statusInfo.innerHTML = `
                <div><strong>Layout Ativo:</strong> ${currentLayout.name}</div>
                <div><strong>Tema:</strong> ${currentLayout.theme}</div>
            `;
        }
        
        function activateLayout(layoutKey) {
            if (window.dataManager.activateLayout(layoutKey)) {
                alert(`Layout "${layoutKey}" ativado com sucesso!`);
                loadLayoutsGrid();
                updateCurrentLayoutStatus();
            } else {
                alert('Erro ao ativar layout!');
            }
        }
        
        function loadCarouselThemes() {
            const grid = document.getElementById('carousel-themes-grid');
            if (!grid || !window.dataManager) return;
            
            const themes = window.dataManager.getCarouselThemes();
            
            grid.innerHTML = themes.map(theme => `
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="relative h-48">
                        <img src="${theme.image}" alt="${theme.name}" class="w-full h-full object-cover">
                        <div class="absolute top-2 right-2">
                            <span class="px-2 py-1 text-xs rounded-full ${theme.active ? 'bg-green-500 text-white' : 'bg-gray-500 text-white'}">
                                ${theme.active ? 'Ativo' : 'Inativo'}
                            </span>
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-bold text-lg mb-2">${theme.name}</h3>
                        <p class="text-sm text-gray-600 mb-2">${theme.category}</p>
                        <p class="text-sm text-gray-700 mb-4">${theme.description.substring(0, 100)}...</p>
                        <div class="flex space-x-2">
                            <button onclick="editCarouselTheme(${theme.id})" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 px-3 rounded text-sm">
                                Editar
                            </button>
                            <button onclick="toggleCarouselTheme(${theme.id})" class="${theme.active ? 'bg-yellow-500 hover:bg-yellow-600' : 'bg-green-500 hover:bg-green-600'} text-white py-2 px-3 rounded text-sm">
                                ${theme.active ? 'Desativar' : 'Ativar'}
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function addCarouselTheme() {
            document.getElementById('carousel-modal-title').textContent = 'Novo Tema de Carrossel';
            document.getElementById('carousel-theme-form').reset();
            document.getElementById('carousel-theme-id').value = '';
            document.getElementById('carousel-theme-modal').classList.remove('hidden');
        }
        
        function editCarouselTheme(themeId) {
            const themes = window.dataManager.getCarouselThemes();
            const theme = themes.find(t => t.id === themeId);
            if (!theme) return;
            
            document.getElementById('carousel-modal-title').textContent = 'Editar Tema de Carrossel';
            document.getElementById('carousel-theme-id').value = theme.id;
            document.getElementById('theme-name').value = theme.name;
            document.getElementById('theme-category').value = theme.category;
            document.getElementById('theme-title').value = theme.title;
            document.getElementById('theme-description').value = theme.description;
            document.getElementById('theme-image').value = theme.image;
            document.getElementById('theme-button-text').value = theme.buttonText;
            document.getElementById('theme-button-link').value = theme.buttonLink;
            document.getElementById('theme-button-color').value = theme.buttonColor;
            document.getElementById('theme-active').checked = theme.active;
            
            document.getElementById('carousel-theme-modal').classList.remove('hidden');
        }
        
        function toggleCarouselTheme(themeId) {
            const themes = window.dataManager.getCarouselThemes();
            const theme = themes.find(t => t.id === themeId);
            if (!theme) return;
            
            window.dataManager.updateCarouselTheme(themeId, { active: !theme.active });
            loadCarouselThemes();
            alert(`Tema ${theme.active ? 'desativado' : 'ativado'} com sucesso!`);
        }
        
        function closeCarouselThemeModal() {
            document.getElementById('carousel-theme-modal').classList.add('hidden');
        }
        
        function loadEstoqueGrid() {
            const estoqueGrid = document.getElementById('estoque-grid');
            if (!estoqueGrid || !window.dataManager) return;
            
            window.dataManager.getActiveProducts().then(products => {
                estoqueGrid.innerHTML = products.map(product => {
                    const stockLevel = product.stock === 0 ? 'Sem estoque' : 
                                      product.stock <= 10 ? 'Estoque baixo' : 'Normal';
                    const stockColor = product.stock === 0 ? 'bg-red-500' : 
                                      product.stock <= 10 ? 'bg-yellow-500' : 'bg-green-500';
                    
                    return `
                        <div class="bg-white rounded-lg shadow-md p-6 border-l-4 ${stockColor}">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="font-bold text-lg">${product.name}</h3>
                                <span class="text-2xl font-bold ${stockColor.replace('bg-', 'text-')}">${product.stock}</span>
                            </div>
                            <p class="text-gray-600 mb-4">${stockLevel}</p>
                        </div>
                    `;
                }).join('');
            });
        }
        
        // Tornar funções globais
        window.loadLayoutsGrid = loadLayoutsGrid;
        window.updateCurrentLayoutStatus = updateCurrentLayoutStatus;
        window.activateLayout = activateLayout;
        window.loadCarouselThemes = loadCarouselThemes;
        window.addCarouselTheme = addCarouselTheme;
        window.editCarouselTheme = editCarouselTheme;
        window.toggleCarouselTheme = toggleCarouselTheme;
        window.closeCarouselThemeModal = closeCarouselThemeModal;
        window.loadEstoqueGrid = loadEstoqueGrid;
    </script>
</body>
</html>
